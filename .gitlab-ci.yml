stages:
  - lint

image: henrywhitaker3/ansible-terraform

.playbooks:
  parallel:
    matrix:
      PLAYBOOK:
        - docker/main.yaml
        - vpn/main.yaml
        - k8s/main.yaml
        - haproxy/main.yaml
        - speakers/main.yaml
        - proxmox/main.yaml
        - pihole/main.yaml

ansible lint:
  stage: lint
  extends: .playbooks
  script:
    - task drone-vault-pass VAULT_PASS="$VAULT_PASS"
    - task lint PLAYBOOK=k8s/main.yaml
