---
- name: Setup Docker host

  hosts: docker

  vars_files:
    - ../vars/main.yaml
    - ../vars/secrets.yaml
    - vars/docker.yaml
    - vars/docker_secrets.yaml

  pre_tasks:
    - name: Update package cache
      become: true
      ansible.builtin.apt:
        update_cache: true
        cache_valid_time: 3600
      changed_when: false

  handlers:
    - name: Handlers
      ansible.builtin.import_tasks: handlers/main.yaml

  roles:
    - common
    - user
    - docker
    - cifs
    - netdata

  tasks:
    - name: Docker
      ansible.builtin.import_tasks: tasks/docker.yaml
    - name: Swag
      ansible.builtin.import_tasks: tasks/swag.yaml
    - name: Torrent
      ansible.builtin.import_tasks: tasks/torrent.yaml
    - name: Monitoring
      ansible.builtin.import_tasks: tasks/monitoring.yaml
    - name: Backup
      ansible.builtin.import_tasks: tasks/backup.yaml
