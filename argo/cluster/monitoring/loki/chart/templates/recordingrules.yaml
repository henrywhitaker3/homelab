apiVersion: v1
kind: ConfigMap
metadata:
  name: loki-rules
  labels:
    loki_rule: ""
data:
  srep-ui.yaml: |
    groups:
      - name: ui
        interval: 1m
        rules:
          - record: srep_ui:requests:count1m
            expr: |
              sum(
                count_over_time({app="srep-ui-chart"} |= `` | pattern `<_> - - <_> "<method> <url> <_>" <status> <size> <_> "<agent>" "<ip>"` [1m])
              ) by(job, status, url, method, container, pod, instance)
