falco:
  metrics:
    enabled: true
    interval: "5m"

  serviceMonitor:
    create: true

  falcosidekick:
    enabled: false
    webui:
      enabled: false

      redis:
        enabled: false

      externalRedis:
        enabled: true
        port: 6379
        url: dragonfly.dragonfly.svc.cluster.local

  grafana:
    dashboards:
      enabled: true
      configMaps:
        falco:
          folder: Falco
          name: falco-grafana-dashboard

  collectors:
    docker:
      enabled: false
    crio:
      enabled: false
    containerd:
      enabled: true
      socket: /run/k3s/containerd/containerd.sock

  customRules:
    default.yaml: |
      - rule: Contact K8S API Server From Container
        override:
          exceptions: append
        exceptions:
          - name: operators
            fields: [container.image.repository]
            comps: [=]
            values:
              - [docker.io/kiwigrid/k8s-sidecar]
              - [quay.io/kiwigrid/k8s-sidecar]
              - [registry.developers.crunchydata.com/crunchydata/postgres-operator]
              - [quay.io/argoproj/argocd]
              - [registry.k8s.io/ingress-nginx/controller]
              - [docker.io/longhornio/longhorn-manager]
              - [registry.developers.crunchydata.com/crunchydata/crunchy-postgres]
              - [oci.external-secrets.io/external-secrets/external-secrets]
              - [ghcr.io/synthetigo/api]
              - [registry.developers.crunchydata.com/crunchydata/crunchy-pgbackrest]
