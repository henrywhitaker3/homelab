falco:
  metrics:
    enabled: true
    interval: "5m"

  serviceMonitor:
    create: true

  falcosidekick:
    enabled: false
    webui:
      enabled: false

      redis:
        enabled: false

      externalRedis:
        enabled: true
        port: 6379
        url: dragonfly.dragonfly.svc.cluster.local

  grafana:
    dashboards:
      enabled: true
      configMaps:
        falco:
          folder: Falco
          name: falco-grafana-dashboard

  collectors:
    containerd:
      enabled: true
      socket: /run/k3s/containerd/containerd.sock

  customRules:
    default.yaml: |
      - rule: Contact K8S API Server From Container
        override:
          exceptions: append
        exceptions:
          - name: longhorn
            fields: [container.name]
            comps: [=]
            values:
              - [longhorn-manager]
          - name: sidecar
            fields: [container.image]
            comps: [startswith]
            values:
              - [docker.io/kiwigrid/k8s-sidecar]
