prompage:
  configuration:
    prometheus: http://kube-prometheus-stack-prometheus:9090

    refresh: 1m

    services:
      - name: Homepage
        group: Services
        query:
          query: probe_http_status_code{instance="https://plexmox.com"}
          expression: int(result) == 200
          bool: true
      - name: Plex
        group: Services
        query:
          query: probe_http_status_code{instance="https://plex.plexmox.com"}
          expression: int(result) == 401
          bool: true
      - name: Requests
        group: Services
        query:
          query: probe_http_status_code{instance="https://overseerr.plexmox.com"}
          expression: int(result) == 200
          bool: true
      - name: Auth
        group: Services
        query:
          query: probe_http_status_code{instance="https://auth.plexmox.com"}
          expression: int(result) == 200
          bool: true
      - name: Postgres
        group: Infra
        query:
          query: avg(pg_up)
          expression: float(result) == 1
          bool: true
      - name: Galera
        group: Infra
        query:
          query: avg(mysql_up{job="mariadb-metrics"})
          expression: int(result) == 1
          bool: true
      - name: Dragonfly
        group: Infra
        query:
          query: sum(rate(dragonfly_uptime_in_seconds[1m]))
          expression: float(result) > 2.5
          bool: true
      - name: MinIO
        group: Infra
        query:
          query: sum(minio_cluster_nodes_offline_total)
          expression: int(result) == 0
          bool: true

  replicaCount: 1

  ingress:
    enabled: true
    annotations:
      kubernetes.io/tls-acme: "true"
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: status.henrywhitaker.com
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
    - secretName: status-henrywhitaker-com-tls
      hosts:
        - status.henrywhitaker.com

